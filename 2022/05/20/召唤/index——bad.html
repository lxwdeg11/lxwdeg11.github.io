<!DOCTYPE html>
<html>
  <head>
  <body id="weather" style="text-align: center; padding: 5px; background-color:skyblue;">
    <title>召唤大狗子神器</title>
    <meta charset="utf-8" />
	<meta name="召唤大狗子">
	
	
	<div id="zhaohuan">
    <textarea id="input_text" style="width: 300px; height: 100px"></textarea>
	<br>
    <button style="width: 150px; height: 200px" onclick="connect()">
      召唤大狗子
    </button>
	</div>
    <script type="text/javascript">
      $(document).click(function () {
        connect();
      });
      var socket;
      function connect() {
        var temp = document.getElementById("input_text").value;
		alert(temp);
        // Create WebSocket connection.
        const socket = new WebSocket("ws://192.168.3.27:10000");

        socket.onopen = function (e) {
          console.log('WebSocket Opened. Sending "Hello"');
          socket.send("Hello");
        };

        socket.onmessage = function (e) {
          console.log("Received:", e.data);
        };

        socket.send("Hello Server!");
        alert("2！");

        // Connection opened
        socket.addEventListener("open", function (event) {
          alert("3！");
          socket.send("Hello Server!");
        });

        // Listen for messages
        socket.addEventListener("message", function (event) {
          alert("3！");
          console.log("Message from server ", event.data);
        });

        var host = "ws://" + "192.168.3.27:" + ":" + "9999" + "/";
        socket = new WebSocket(host);
        try {
          socket.onopen = function (msg) {
            $("btnConnect").disabled = true;
            alert("连接成功！");
          };

          socket.onmessage = function (msg) {
            if (typeof msg.data == "string") {
              displayContent(msg.data);
            } else {
              alert("非文本消息");
            }
          };

          socket.onclose = function (msg) {
            alert("socket closed!");
          };
        } catch (ex) {
          alert("连接失败！");
          log(ex);
        }
      }

      function send() {
        var msg = $("sendText").value + "\0";
        socket.send(msg);
      }

      window.onbeforeunload = function () {
        try {
          socket.close();
          socket = null;
        } catch (ex) {}
      };
    </script>
	</body>
  <link rel="stylesheet" href="../zhaohuan.css"/>
  </head>
  
</html>

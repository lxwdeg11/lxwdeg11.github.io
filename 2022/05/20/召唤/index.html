<!DOCTYPE html>
<!-- saved from url=(0121)file:///C:/Users/LXWDE_~1/AppData/Local/Temp/MicrosoftEdgeDownloads/761f5f96-c490-4a5b-b675-0c6035411f24/index%20(1).html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title></title>


</head>
<body background="background_kevin.jpg" id="zhaohuan" style="text-align: center; padding: 5px; background-color:skyblue;">
<textarea align="center" id="input_text" style="width:50px;height:200px;"></textarea>
<br>
<button align="center" style="width:150px;height:200px" onclick="btn_connect()">召唤大狗子10</button>
<button align="center" style="width:150px;height:200px" onclick="drink_connect()">喝水</button>
<script type="text/javascript">
	
	
		var socket;
        function connect(message) {
			var temp=document.getElementById("input_text").value;
	
			
		var wsConnection = new WebSocket("wss://www.lixuewen.ml:8000");
		wsConnection.onopen = function () {
			var socketMessageToServer = {};
			socketMessageToServer.text = "召唤大狗子：" + temp;
			wsConnection.send(JSON.stringify(socketMessageToServer));
			alert('已经发送消息给大狗子1');
		};
		wsConnection.onerror = function(event) {
			alert("无法连接到服务器" + "www.lixuewen.ml:8000");
			;
		}
		socket.onmessage = function(e) {
			alert("收到message");
			console.log('Received:', e.data);
		};
		return;


		


		
		
			
			// Create WebSocket connection lxw.
				var times = 0;
				var server_ok = -1;
				var error_times = 0;
				var server_list =new Array(); 
				server_list[0]='wss://159.223.48.49:8000';     
					server_list[1]='wss://192.168.3.27:8000';
					server_list[2]='wss://192.168.3.27:8000';
					
				console.log(message);
				while (times <= 2) {
					
					
				//alert(server_list[times]);
				const socket = new WebSocket(server_list[times]);
				
				socket.onerror=function(event){
					error_times++;
					
					//if (error_times == 3)
						alert("无法连接到服务器");
					server_ok = 0;
					console.log("Error");
				};			
			
			
				socket.onopen = function(e) {
					server_ok = 1;
					console.log('WebSocket Opened. Sending "Hello"');
					socket.send(message + temp);
					alert('已经发送消息给大狗子');
				  };

				  socket.onmessage = function(e) {
					console.log('Received:', e.data);
				  };
				  




				// Listen for messages
				//如果要指定多个回调函数，可以使用addEventListener方法。
				socket.addEventListener('message', function (event) {

					console.log('Message from server ', event.data);
				});
				if (server_ok == 1)
					break;
				
				times++;
				}


            
        }

        
		function btn_connect() {
			connect("");
		}
		function drink_connect() {
			connect("喝水");
		}
		
</script>





  </body></html>